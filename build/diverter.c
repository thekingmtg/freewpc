
/* This file was autogenerated by 'ctemp' from  for class divhold. */


#include <freewpc.h>
#include "diverter.h"


/** Each diverter has it's own timer variable.
 *
 * < 0 - use hold power only
 * > 0 - full power to both hold and power circuits
 *   0 - no power
 */
__fastram__ S8 diverter_timer;

/**
 * The user API to start a diverter.
 */
void diverter_start (void) {
	disable_interrupts ();
	
	/* Start the high power pulse */
	diverter_timer = DIVERTER_POWER_TICKS;	
	
	enable_interrupts ();
}

/**
 * The user API to stop a diverter.
 */
void diverter_stop (void) {
	disable_interrupts ();
	
	diverter_timer = 0;
	
	enable_interrupts ();
}

CALLSET_ENTRY (diverter, init)
{
	diverter_timer = 0;
	dbprintf("Diverter power: 'SOL_DIVERTER_POWER' (%d)\n", SOL_DIVERTER_POWER);
	dbprintf("Diverter hold: 'SOL_DIVERTER_HOLD' (%d)\n", SOL_DIVERTER_HOLD);
#if (DIVERTER_MODE > 0)
	dbprintf("Diverter mode: FLIPTRONICS\n");
#else
	dbprintf("Diverter mode: NORMAL\n");
#endif	
}

CALLSET_ENTRY (diverter, tilt, stop_game)
{
	diverter_stop ();
}

/* vim: set filetype=c: */


